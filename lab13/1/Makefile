CC = gcc
CFLAGS = -Wall -Wextra -Werror -pedantic -c
LDFLAGS_POSIX = -lrt

SRC_POSIX_SERVER = server_posix.c
SRC_POSIX_CLIENT = client_posix.c
SRC_SYSV_SERVER = server_systemV.c
SRC_SYSV_CLIENT = client_systemV.c

OBJ_POSIX_SERVER = server_posix.o
OBJ_POSIX_CLIENT = client_posix.o
OBJ_SYSV_SERVER = server_systemV.o
OBJ_SYSV_CLIENT = client_systemV.o

EXEC_POSIX_SERVER = server_posix
EXEC_POSIX_CLIENT = client_posix
EXEC_SYSV_SERVER = server_systemV
EXEC_SYSV_CLIENT = client_systemV

all: $(EXEC_POSIX_SERVER) $(EXEC_POSIX_CLIENT) $(EXEC_SYSV_SERVER) $(EXEC_SYSV_CLIENT)
		rm *.o

$(EXEC_POSIX_SERVER): $(OBJ_POSIX_SERVER)
		$(CC) $(OBJ_POSIX_SERVER) -o $(EXEC_POSIX_SERVER) $(LDFLAGS_POSIX)

$(EXEC_POSIX_CLIENT): $(OBJ_POSIX_CLIENT)
		$(CC) $(OBJ_POSIX_CLIENT) -o $(EXEC_POSIX_CLIENT) $(LDFLAGS_POSIX)

$(EXEC_SYSV_SERVER): $(OBJ_SYSV_SERVER)
		$(CC) $(OBJ_SYSV_SERVER) -o $(EXEC_SYSV_SERVER)

$(EXEC_SYSV_CLIENT): $(OBJ_SYSV_CLIENT)
		$(CC) $(OBJ_SYSV_CLIENT) -o $(EXEC_SYSV_CLIENT)

%.o: %.c
		$(CC) $(CFLAGS) $< -o $@

clean:
		rm -f $(OBJ_POSIX_SERVER) $(OBJ_POSIX_CLIENT) $(OBJ_SYSV_SERVER) $(OBJ_SYSV_CLIENT) $(EXEC_POSIX_SERVER) $(EXEC_POSIX_CLIENT) $(EXEC_SYSV_SERVER) $(EXEC_SYSV_CLIENT)

.PHONY: all clean
